<!DOCTYPE html>
<html>
<head>
    <title>FMG Heightmap Debug Test</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
        }
        #output {
            white-space: pre;
            background: #f0f0f0;
            padding: 10px;
            border: 1px solid #ccc;
            height: 400px;
            overflow-y: auto;
        }
        button {
            margin: 5px;
            padding: 10px;
        }
    </style>
</head>
<body>
    <h1>FMG Heightmap Debug Test</h1>
    
    <p>
        This page will help debug the heightmap generation by running FMG with specific parameters
        and logging all intermediate values.
    </p>
    
    <div>
        <button onclick="openFMG()">1. Open FMG in New Window</button>
        <button onclick="showInstructions()">2. Show Debug Instructions</button>
    </div>
    
    <h2>Instructions</h2>
    <div id="instructions" style="display: none; background: #fffee0; padding: 10px; margin: 10px 0;">
        <ol>
            <li>Click "Open FMG in New Window"</li>
            <li>Open browser Developer Console (F12)</li>
            <li>In the console, paste these commands one by one:</li>
            <pre>
// Set parameters
document.getElementById('optionsSeed').value = '651658815';
document.getElementById('mapSizeInput').value = 'cropped';
graphWidth = 300;
graphHeight = 300;
document.getElementById('templateInput').value = 'lowIsland';
document.getElementById('cellsNumberInput').value = '10000';

// Generate map
regenerateMap('menu');
            </pre>
            <li>Wait for generation to complete (watch console logs)</li>
            <li>Then run this to export debug data:</li>
            <pre>
// Export debug data
var debugData = exportFmgDebugData();
console.log(JSON.stringify(debugData, null, 2));

// Copy to clipboard
copy(JSON.stringify(debugData, null, 2));
console.log("Debug data copied to clipboard!");
            </pre>
            <li>Paste the debug data into a file named <code>fmg_debug_output.json</code></li>
        </ol>
    </div>
    
    <h2>Expected Console Output</h2>
    <div id="output">
You should see output like:

Installing FMG debug patches...
Debug patches installed successfully
=== HEIGHTMAP GENERATION START ===
Graph dimensions: 100 x 100
Cells desired: 10000
Seed: 651658815
Executing template: lowIsland
Template string: Hill 1 90-99 60-80 45-55
...
addHill(1, 90-99, 60-80, 45-55)
  Random log size before: 0
  Randoms used: XXX
  Non-zero cells: before = 0, after = XXX
  Cells affected: XXX
...
=== HEIGHTMAP GENERATION END ===
Random calls made: XXX
Heights analysis:
  Min: X
  Max: XX
  Mean: XX.X
  Land cells: XXXX
  First 20: [X, X, X, ...]
    </div>
    
    <script>
        function openFMG() {
            window.open('http://localhost:9000/index.html', 'fmg_debug', 'width=1200,height=800');
        }
        
        function showInstructions() {
            document.getElementById('instructions').style.display = 'block';
        }
    </script>
</body>
</html>